package pages

import "stats-agent/web/templates/layout"
import "stats-agent/web/templates/components"
import "stats-agent/web/types"
import "github.com/google/uuid"

templ ChatPage(activeSessionID uuid.UUID, sessions []types.Session, messages []types.ChatMessage) {
	@layout.Base("Chat") {
		<div class="flex h-full">
			// Sidebar
			<div class="w-72 flex-shrink-0">
				@components.SessionList(sessions, activeSessionID)
			</div>

			// Main Chat Area
			<div class="flex-1 flex flex-col">
				<div class="flex-1 flex flex-col items-center justify-center p-4 space-y-6">
					<div class="w-full max-w-4xl h-full flex flex-col">
						// Messages container
						<div id="messages" class="flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin">
							if len(messages) == 0 {
								@components.WelcomeMessage()
							} else {
								for _, msg := range messages {
									if msg.Role == "user" {
										@components.UserMessage(msg)
									} else {
										// This will handle agent and tool messages
									}
								}
							}
						</div>
						// Form container
						<div class="p-6 border-t border-gray-200/50">
							@components.ChatForm(activeSessionID.String())
						</div>
					</div>
				</div>
			</div>
		</div>
	}
}