{{- bos_token }}
{%- if messages[0]['role'] == 'system' %}
    {%- set system_message = messages[0]['content'] %}
    {%- set loop_messages = messages[1:] %}
{%- else %}
    {%- set loop_messages = messages %}
{%- endif %}
{%- if system_message is defined %}
[SYSTEM_PROMPT]{{ system_message }}[/SYSTEM_PROMPT]
{%- endif %}
{%- for message in loop_messages %}
    {%- if message['role'] == 'user' %}
[INST]{{ message['content'] }}[/INST]
    {%- elif message['role'] == 'assistant' %}
{{ message['content'] }}
        {%- if not loop.last %}
{{ eos_token }}
        {%- endif %}
    {%- elif message['role'] == 'tool' %}
[TOOL_RESULT]{{ message['content'] }}[/TOOL_RESULT]
    {%- endif %}
{%- endfor %}
{%- if add_generation_prompt %}

{%- endif %}